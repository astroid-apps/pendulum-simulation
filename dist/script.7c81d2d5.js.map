{"version":3,"sources":["RungeKuttaSolver.js","Viewer.js","script.js"],"names":["add","v1","v2","map","e","i","add4","v3","v4","mul","k","v","module","exports","dt","x","f","t","dt2","dt6","step","k1","k2","k3","k4","getX","getTime","getR","m","Math","pow","PI","drawCenter","ctx","r","beginPath","arc","fill","drawArm","l","moveTo","lineTo","stroke","closePath","elementId","width","height","scale","canvas","document","getElementById","getContext","fillStyle","strokeStyle","draw","th","save","clearRect","translate","rotate","restore","RungeKuttaSolver","require","Viewer","info","random","min","max","g","rks","sin","vw","setInterval","dth","vx","cos","vy","py","E","U","innerHTML","toFixed","join"],"mappings":"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","file":"script.7c81d2d5.js","sourceRoot":"..\\src","sourcesContent":["/*\r\n\tRunge–Kutta法による連立常微分方程式の計算\r\n\t2020/10/21 新規作成\r\n*/\r\n\r\n//[v1] + [v2]\r\nconst add = function(v1,v2){\r\n\treturn v1.map((e,i) => e + v2[i]);\r\n};\r\n\r\n//[v1] + [v2] + [v3] + [v4]\r\nconst add4 = function(v1,v2,v3,v4){\r\n\treturn v1.map((e,i) => e + v2[i] + v3[i] + v4[i]);\r\n};\r\n\r\n//k * [v]\r\nconst mul = function(k,v){\r\n\treturn v.map(e => e * k);\r\n};\r\n\r\nmodule.exports = function(dt,x,f){\r\n\t\r\n\tlet t = 0;\r\n\tconst dt2 = dt * 0.5;\r\n\tconst dt6 = dt / 6;\r\n\t\r\n\tthis.step = function(){\r\n\t\tconst k1 = f(t, x);\r\n\t\tconst k2 = f(t + dt2, add(x,mul(dt2,k1)));\r\n\t\tconst k3 = f(t + dt2, add(x,mul(dt2,k2)));\r\n\t\tconst k4 = f(t + dt, add(x,mul(dt,k3)));\r\n\t\t\r\n\t\tx = add(x,mul(dt6,add4(k1,mul(2,k2),mul(2,k3),k4)));\r\n\t\tt += dt;\r\n\t};\r\n\t\r\n\tthis.getX = function(){\r\n\t\treturn x;\r\n\t};\r\n\t\r\n\tthis.getTime = function(){\r\n\t\treturn t;\r\n\t};\r\n}","\r\n//質量m[kg]で密度d[km/m3]の球の半径\r\nconst getR = function(m){\r\n//\tconst d = 1000; //水\r\n\tconst d = 7870; //鉄\r\n\treturn Math.pow((m/d)*3/(4*Math.PI),1/3);\r\n};\r\n\r\n//中心を描く\r\nconst drawCenter = function(ctx,r){\r\n\tctx.beginPath();\r\n\tctx.arc(0,0,r,0,Math.PI * 2);\r\n\tctx.fill();\r\n};\r\n\r\n//振り子を描く\r\nconst drawArm = function(ctx,l,r){\r\n\tctx.beginPath();\r\n\tctx.moveTo(0,0);\r\n\tctx.lineTo(0,l);\r\n\tctx.stroke();\r\n\tctx.closePath();\r\n\t\r\n\tctx.beginPath();\r\n\tctx.arc(0,l,r,0,Math.PI * 2);\r\n\tctx.fill();\r\n};\r\n\r\n//表示画面\r\n//scale[px/m]\r\nmodule.exports = function(elementId,width,height,scale){\r\n\tconst canvas = document.getElementById(elementId);\r\n\tcanvas.width = width;\r\n\tcanvas.height = height;\r\n\t\r\n\tconst ctx = canvas.getContext(\"2d\");\r\n\tctx.fillStyle = \"rgba(0,0,0,1.0)\";\r\n\tctx.strokeStyle = \"rgba(0,0,0,1.0)\";\r\n\t\r\n\tthis.draw = function(th,l,m){\r\n\t\tctx.save();\r\n\t\tctx.clearRect(0,0,width,height);\r\n\t\tctx.translate(width * 0.5,height * 0.5);\r\n\t\t\r\n\t\tdrawCenter(ctx,5);\r\n\t\t\r\n\t\tctx.rotate(-th);\r\n\t\tdrawArm(ctx,l * scale,getR(m) * scale);\r\n\t\t\r\n\t\tctx.restore();\r\n\t};\r\n};\r\n\r\n","/*\r\n\t振り子シミュレーション\r\n\t2020/10/21 新規作成\r\n*/\r\n\r\nconst RungeKuttaSolver = require(\"./RungeKuttaSolver.js\");\r\nconst Viewer = require(\"./Viewer.js\");\r\n\r\nconst info = document.getElementById(\"info\");\r\n\r\n//min～maxのランダムな値\r\nconst random = function(min,max){\r\n\treturn (max - min) * Math.random() + min;\r\n};\r\n\r\n//条件\r\nconst m = random(1,10);\r\nconst l = random(0.1,1.0);\r\nconst th = random(-3,3);\r\n\r\nconst g = 9.80665;\t//[m/s2]\r\n\r\n// th'' = - g * sin(th) / l\r\nconst rks = new RungeKuttaSolver(0.01,[th,0],function(t,x){\r\n\treturn [\r\n\t\tx[1],\r\n\t\t-g * Math.sin(x[0]) / l\r\n\t];\r\n});\r\n\r\nconst vw = new Viewer(\"cv\",300,300,150);\r\n\r\nsetInterval(function(){\r\n\tconst th = rks.getX()[0];\r\n\tconst dth = rks.getX()[1];\r\n\t\r\n\t//速度(x,yの各成分)\r\n\tconst vx = l * dth * Math.cos(th);\r\n\tconst vy = l * dth * Math.sin(th);\r\n\t\r\n\t//位置(y方向)\r\n\tconst py = -l * Math.cos(th);\r\n\t\r\n\t//運動エネルギー\r\n\tconst E = m * (vx * vx + vy * vy) * 0.5;\r\n\t\r\n\t//位置エネルギー\r\n\tconst U = m * g * (l + py);\r\n\t\r\n\t//表示\r\n\tvw.draw(th,l,m);\r\n\t\r\n\tinfo.innerHTML = [\r\n\t\t\"t[s]=\" + rks.getTime().toFixed(2),\r\n\t\t\"th[rad]=\" + th.toFixed(2),\r\n\t\t\"th'[rad/s]=\" + dth.toFixed(2),\r\n\t\t\"L[m]=\" + l.toFixed(2),\r\n\t\t\"M[kg]=\" + m.toFixed(2),\r\n\t\t\"E[J]=\" + (E + U).toFixed(4),\r\n\t].join(\"<br>\");\r\n\t\r\n\tfor(let i=0;i<3;i++) rks.step();\r\n},30)\r\n"]}